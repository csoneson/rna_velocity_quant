Trying to set attribute `.obs` of view, making a copy.
input adfile:  output/anndata/anndata_alevin_prepref_isocollapse_cdna_introns_decoy.h5ad
output directory:  plots/velocity
output adfile:  output/anndata_with_velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_with_velocity.h5ad
gene set file:  output/genesets/shared_genes.txt
Abundance of ['spliced', 'unspliced']: [0.82 0.18]
Normalized count data: unspliced.
Normalized count data: X, spliced.
computing neighbors
    finished (0:00:04) --> added to `.uns['neighbors']`
    'distances', weighted adjacency matrix
    'connectivities', weighted adjacency matrix
computing moments based on connectivities
    finished (0:00:00) --> added 
    'Ms' and 'Mu', moments of spliced/unspliced abundances (adata.layers)
recovering dynamics
... 1%... 3%... 4%... 6%... 7%... 8%... 10%... 12%... 13%... 15%... 16%... 18%... 20%... 22%... 24%... 25%... 27%... 29%... 30%... 32%... 33%... 35%... 36%... 38%... 40%... 41%... 44%... 46%... 47%... 49%... 50%... 51%... 52%... 54%... 55%... 57%... 58%... 60%... 62%... 64%... 65%... 67%... 69%... 70%... 72%... 74%... 75%... 77%... 79%... 81%... 83%... 84%... 85%... 86%... 88%... 90%... 91%... 92%... 94%... 95%... 97%... 99%... 100%    finished (0:03:36) --> added 
    'fit_pars', fitted parameters for splicing dynamics (adata.var)
computing velocities
    finished (0:00:01) --> added 
    'velocity', velocity vectors for each individual cell (adata.layers)
computing velocity graph
... 100%    finished (0:00:02) --> added 
    'velocity_graph', sparse matrix with cosine correlations (adata.uns)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_pca', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_PCA_stream.png
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_tsne', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_TSNE_stream.png
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_umap', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_stream.png
Renamed 'PCA_starsolo_concatenated' to convention 'X_PCA_starsolo_concatenated' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_starsolo_concatenated', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_PCA_starsolo_concatenated_stream.png
Renamed 'TSNE_starsolo_concatenated' to convention 'X_TSNE_starsolo_concatenated' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_starsolo_concatenated', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_TSNE_starsolo_concatenated_stream.png
Renamed 'UMAP_starsolo_concatenated' to convention 'X_UMAP_starsolo_concatenated' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_starsolo_concatenated', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_starsolo_concatenated_stream.png
Renamed 'PCA_starsolo_summed' to convention 'X_PCA_starsolo_summed' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_starsolo_summed', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_PCA_starsolo_summed_stream.png
Renamed 'TSNE_starsolo_summed' to convention 'X_TSNE_starsolo_summed' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_starsolo_summed', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_TSNE_starsolo_summed_stream.png
Renamed 'UMAP_starsolo_summed' to convention 'X_UMAP_starsolo_summed' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_starsolo_summed', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_starsolo_summed_stream.png
Renamed 'PCA_starsolo_unspliced' to convention 'X_PCA_starsolo_unspliced' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_starsolo_unspliced', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_PCA_starsolo_unspliced_stream.png
Renamed 'TSNE_starsolo_unspliced' to convention 'X_TSNE_starsolo_unspliced' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_starsolo_unspliced', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_TSNE_starsolo_unspliced_stream.png
Renamed 'UMAP_starsolo_unspliced' to convention 'X_UMAP_starsolo_unspliced' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_starsolo_unspliced', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_starsolo_unspliced_stream.png
Renamed 'PCA_starsolo' to convention 'X_PCA_starsolo' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_starsolo', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_PCA_starsolo_stream.png
Renamed 'TSNE_starsolo' to convention 'X_TSNE_starsolo' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_starsolo', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_TSNE_starsolo_stream.png
Renamed 'UMAP_starsolo' to convention 'X_UMAP_starsolo' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_starsolo', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_starsolo_stream.png
Renamed 'PCA_alevin_spliced' to convention 'X_PCA_alevin_spliced' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_alevin_spliced', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_PCA_alevin_spliced_stream.png
Renamed 'TSNE_alevin_spliced' to convention 'X_TSNE_alevin_spliced' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_alevin_spliced', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_TSNE_alevin_spliced_stream.png
Renamed 'UMAP_alevin_spliced' to convention 'X_UMAP_alevin_spliced' (adata.obsm).
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_alevin_spliced', embedded velocity vectors (adata.obsm)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_alevin_spliced_stream.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_stream_G2M.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_alevin_spliced_stream_G2M.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_stream_S.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_alevin_spliced_stream_S.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_alevin_spliced_velocitygraph.png
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_alevin_spliced', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_alevin_spliced', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_alevin_spliced', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_starsolo', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_starsolo', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_starsolo', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_starsolo_concatenated', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_starsolo_concatenated', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_starsolo_concatenated', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_starsolo_summed', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_starsolo_summed', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_starsolo_summed', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_PCA_starsolo_unspliced', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_TSNE_starsolo_unspliced', embedded velocity vectors (adata.obsm)
computing velocity embedding
    finished (0:00:00) --> added
    'velocity_UMAP_starsolo_unspliced', embedded velocity vectors (adata.obsm)
computing terminal states
    identified 1 region of root cells and 2 regions of end points 
    finished (0:00:00) --> added
    'root_cells', root cells of Markov diffusion process (adata.obs)
    'end_points', end points of Markov diffusion process (adata.obs)
computing latent time
    finished (0:00:00) --> added 
    'latent_time', shared time (adata.obs)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_heatmap_top_genes_heatmap.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_top_genes_scatter.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_stream_latent_time.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_alevin_spliced_stream_latent_time.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_UMAP_alevin_spliced_latent_time.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_genes_from_paper_scatter.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_genes_from_paper_velocity.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_genes_from_paper_vs_latent_time.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_genes_of_interest_scatter.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_genes_of_interest_velocity.png
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_genes_of_interest_vs_latent_time.png
ranking velocity genes
    finished (0:00:00) --> added 
    'rank_velocity_genes', sorted scores by group ids (adata.uns)
saving figure to file plots/velocity/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes/anndata_alevin_prepref_isocollapse_cdna_introns_decoy_shared_genes_scvelo_velocity_genes.png
--> added 'velocity_confidence' (adata.obs)
--> added 'velocity_confidence_transition' (adata.obs)
Running scvelo 0.1.24 (python 3.7.3) on 2020-01-18 10:27.
